--
-- SCRIPT D_Channel, entity for URM
-- Engine: Teradata
-- Server: 10.167.37.107
-- DB: AR_PROD_ODS_DATA_VW
-- Owner: Big Data, Telefonica Argentina

-- El campo GLOBAL_CHANNEL_ID se define de acuerdo a la definicion de la dimensional global gbl_line_status a la fecha:20180131, asi:
--'GLOBAL_CHANNEL_ID','GLOBAL_CHANNEL_DES'
-- -1|Unknown
-- 1|Indirect
-- 2|Direct
-- 3|Others
--
SELECT 
'722-070' AS OPERATOR_ID,
SALES_SERVICE_CHANNEL_KEY AS CHANNEL_ID,
SALES_CHANNEL_NAME AS CHANNEL_NAME,
CASE WHEN SALES_SERVICE_CHANNEL_KEY IN (1001,1002,1003,1004,1005,1008,1020,1021,1022,1040,2002) THEN  2 
 WHEN SALES_SERVICE_CHANNEL_KEY IN (1000,1007,1009,2001) THEN  1
  WHEN SALES_SERVICE_CHANNEL_KEY IN (1006) THEN  3
ELSE -1 END  AS GLOBAL_CHANNEL_ID 
 FROM AR_PROD_ODS_DATA_VW.SALES_SERVICE_CHANNEL;
 
 
